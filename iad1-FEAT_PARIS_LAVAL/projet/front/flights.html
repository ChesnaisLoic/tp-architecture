<!DOCTYPE html>
<html>

<head>
  <title>Liste des vols</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
  <link rel="stylesheet" href="main.css">
  <meta charset="UTF-8">
</head>

<body class="bg">
  <h1 class="text-center" style="margin-top: 40px">Liste des vols disponibles</h1>

  <div class="text-center" style="margin-top: 30px">
    <button class="btn btn-outline-dark" onclick="openMenu()">Revenir au menu</button>
  </div>
  
  <div class="text-center" style="margin-top: 20px">
    <button class="btn btn-outline-dark" onclick="openBooking()">Aller aux réservations</button>
  </div>

  <div class="row">
    <div id="flights" class="card-deck" style="margin-top: 40px; margin-left: 30px; margin-right: 30px">

    </div>
  </div>
  
  <script>
    const email = localStorage.getItem('email');

    fetch('https://pokeapi.co/api/v2/pokemon/')
      .then(response => response.json())
      .then(function (json) {

        console.log(json);

        for (let i = 0; i < json.results.length; i++) {
          flight_code = "flight_" + i
          flight_src = "src"
          flight_dst = "dst"
          flight_date = "date"
          flight_price = "400"
          flight_seat_nb = "38"

          var flight_card = '\
            <div class="col-sm-4" style="margin-bottom: 40px">\
              <div class="card">\
                <div class="card-body">\
                  <h5 class="card-title" id="identifiantVol">' + flight_code + '</h5>\
                  <p class="card-text">\
                  <p>Aéroport de départ :<a id="departureAirport"> ' + flight_src + ' </a></p>\
                  <p>Aéroport d\'arrivée :<a id="landingAirport"> ' + flight_dst + ' </a></p>\
                  <p>Date :<a id="dateVol"> ' + flight_date + ' </a></p>\
                  <p>Prix :<a id="prixBillet"> ' + flight_price + ' </a> €</p>\
                  <p>Places Disponibles :<a id="placeDispo"> ' + flight_seat_nb + ' </a></p>\
                  </p>\
                </div>\
                <div class="card-footer" style="text-align: center">\
                  <a href="#" id=reserve class="card-link" onclick="book(\'' + flight_code + '\')">Réserver</a>\
                </div>\
              </div>\
            </div>\
          ';

          document.getElementById("flights").innerHTML += flight_card
        }
      });

      function book(flight_id) {
        // let url = "";
        // var data = {email: email, flight_id: flight_id}
        // $.post(url, data, function (res) {
        //     alert(res);
        //   });
        console.log(flight_id);
      }

      function openMenu() {
        window.location.href = 'menu.html';
      }

      function openBooking() {
        window.location.href = 'booking.html';
      }
  </script>
</body>

</html>